<!DOCTYPE html>
<html>
<head>
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSQ484FfzI8HUcaveSkjX8OGEE7MxxnRKUSNw&s" alt="Logo" style="position: absolute; top: 10px; right: 10px; height: 50px; width: 50px;">
  <title>prototypePL.snuc/simulation</title>
  <style>
    .BandgapApparatus {
      width: 910px;
      height: 600px;
      margin: 30px auto;
      

    }
    #turnOnOvenButton {
      display: block;
      margin: 10px auto;
      padding: 10px 20px;
      font-size: 20px;
      background-color:antiquewhite;
      color: brown;
      cursor: pointer;
      font-weight: bold;
      font-family: Calibri, sans-serif;
    }

    
    #takeReadingButton{
      
   
      display: block;
      margin: 10px auto;
      padding: 10px 20px;
      font-size: 20px;
      background-color:antiquewhite;
      color: brown;
      cursor: pointer;
      font-weight: bold;
      font-family: Calibri, sans-serif;
    }
       
    #valuesArray {
      margin-top: 20px;
      text-align: center;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    table, th, td {
      border: 1px solid black;
    }

    th, td {
      padding: 10px;
      text-align: center;
    }
    #generateGraphButton{
      
   
      display: block;
      margin: 10px auto;
      padding: 10px 20px;
      font-size: 20px;
      background-color:antiquewhite;
      color: brown;
      cursor: pointer;
      font-weight: bold;
      font-family: Calibri, sans-serif;
    }




  </style>
</head>
<body>
  <button id="turnOnOvenButton" onclick="startAnimation()">Turn on Oven</button>
  <button id="takeReadingButton" style="display: none;" onclick="showReadings()">Take reading</button>
  <button id="generateGraphButton" style="display: none;" onclick="generateGraph()">Generate Graph</button>
  <div class="BandgapApparatus">
    <svg width="100%" height="100%">
      <rect x="00" y="500" width="200" height="50" fill="grey" />
      <rect x="00" y="340" width="40" height="170" fill="grey" />
      <rect x="160" y="340" width="40" height="170" fill="grey" />
      <rect x="40" y="360" width="120" height="140" fill="cyan" />
      <rect x="0" y="320" width="75" height="20" fill="grey" />
      <rect x="125" y="320" width="75" height="20" fill="grey" />
      <rect x="75" y="260" width="50" height="200" fill="white" stroke="black" stroke-width="0.5" />
      <rect x="75" y="210" width="50" height="250" fill="white" stroke="black" stroke-width="0.5" />
      <rect x="75" y="340" width="50" height="120" fill="yellow" />
      <rect x="90" y="35" width="20" height="400" fill="orange" stroke="black" stroke width="0.5"/>
      <polygon points="90,440 90,460 105,450" width="30" height="10" fill="black" stroke="black" stroke width="0.5"/>
      <line x1="105" y1="440" x2="105" y2="460" stroke="black" stroke width="03"/>
      <rect x="400" y="250" width="500" height="300" fill="grey" stroke="black" stroke width="0.5"/>
      <rect x="420" y="270" width="460" height="260" fill="antiquewhite" stroke="black" stroke width="0.5"/>
      <line x1="105" y1="450" x2="120" y2="450" stroke="black" stroke width="03"/>
      <line x1="120" y1="450" x2="120" y2="200" stroke="black" stroke width="03"/>
      <line x1="160" y1="200" x2="120" y2="200" stroke="black" stroke width="03"/>
      <line x1="160" y1="200" x2="300" y2="500" stroke="black" stroke width="03"/>
      <line x1="550" y1="500" x2="300" y2="500" stroke="black" stroke width="03"/>
      <line x1="550" y1="500" x2="550" y2="480" stroke="black" stroke width="03"/>
      <line x1="90" y1="450" x2="80" y2="450" stroke="black" stroke width="03"/>
      <line x1="80" y1="190" x2="80" y2="450" stroke="black" stroke width="03"/>
      <line x1="80" y1="190" x2="90" y2="190" stroke="black" stroke width="03"/>
      <line x1="170" y1="190" x2="110" y2="190" stroke="black" stroke width="03"/>
      <line x1="170" y1="190" x2="310" y2="480" stroke="black" stroke width="03"/>
      <line x1="450" y1="480" x2="310" y2="480" stroke="black" stroke width="03"/>
      <rect x="460" y="325" width="150" height="50" fill="grey" stroke="black" stroke width="0.5"/>
      <rect x="690" y="325" width="150" height="50" fill="grey" stroke="black" stroke width="0.5"/>
      <rect x="465" y="330" width="140" height="40" fill="black" stroke="black" stroke width="0.5"/>
      <rect x="695" y="330" width="140" height="40" fill="black" stroke="black" stroke width="0.5"/>
      <polygon points="500,470 500,490 515,480" width="30" height="10" fill="black" stroke="black" stroke width="0.5"/>
      <line x1="515" y1="470" x2="515" y2="490" stroke="black" stroke width="03"/>
      <circle cx="460" cy="480" r="10" fill="grey" stroke="black" stroke-width="1" />
      <circle cx="550" cy="480" r="10" fill="grey" stroke="black" stroke-width="1" />
      <circle cx="460" cy="400" r="10" fill="grey" stroke="black" stroke-width="1" />
      <circle cx="550" cy="400" r="10" fill="grey" stroke="black" stroke-width="1" />
      <text x="452.5" y="430" fill="black" font-size="25" font-family="calibiri">+</text>
      <text x="542.5" y="430" fill="black" font-size="25" font-family="calibiri"> -</text>
      <text x="712.5" y="430" fill="black" font-size="25" font-family="calibiri">+</text>
      <text x="802.5" y="430" fill="black" font-size="25" font-family="calibiri"> -</text>
      <circle cx="715" cy="480" r="10" fill="grey" stroke="black" stroke-width="1" />
      <circle cx="805" cy="480" r="10" fill="grey" stroke="black" stroke-width="1" />
      <circle cx="715" cy="400" r="10" fill="grey" stroke="black" stroke-width="1" />
      <circle cx="805" cy="400" r="10" fill="grey" stroke="black" stroke-width="1" />
      <text x="710" y="510" fill="black" font-size="25" font-family="calibiri">+</text>
      <text x="800" y="510" fill="black" font-size="25" font-family="calibiri"> -</text>
      <line x1="470" y1="480" x2="540" y2="400" stroke="black" stroke width="03"/>
      <line x1="560" y1="480" x2="795" y2="400" stroke="black" stroke width="03"/>
      <line x1="805" y1="470" x2="805" y2="410" stroke="black" stroke width="03"/>
      <line x1="460" y1="390" x2="460" y2="380" stroke="black" stroke width="03"/>
      <line x1="715" y1="380" x2="460" y2="380" stroke="black" stroke width="03"/>
      <line x1="715" y1="390" x2="715" y2="380" stroke="black" stroke width="03"/>
      <line x1="715" y1="410" x2="715" y2="470" stroke="black" stroke width="03"/>
      <rect x="90" y="00" width="20" height="435" fill="orange" stroke="black" stroke-width="0.5" />
      <rect id="thermometer-reading" x="90" y="330" width="4" height="100" fill="red" stroke="black" stroke-width="0.5" />
      <text x="30" y="570" fill="black" font-size="20" font-family="calibri">Germanium Diode</text>

      
      <g id="thermometer-scale">
        
        <line x1="110" y1="430" x2="100" y2="430" stroke="black" stroke-width="1" />



        <line x1="110" y1="390" x2="100" y2="390" stroke="black" stroke-width="0.5" />
        <text x="97.5" y="400" font-size="10" font-family="Arial" fill="black">10</text>

        <line x1="110" y1="350" x2="100" y2="350" stroke="black" stroke-width="0.5" />
        <text x="97.5" y="360" font-size="10" font-family="Arial" fill="black">20</text>

        <line x1="110" y1="310" x2="100" y2="310" stroke="black" stroke-width="0.5" />
        <text x="97.5" y="320" font-size="10" font-family="Arial" fill="black">30</text>

        <line x1="110" y1="270" x2="100" y2="270" stroke="black" stroke-width="0.5" />
        <text x="97.5" y="280" font-size="10" font-family="Arial" fill="black">40</text>

        <line x1="110" y1="230" x2="100" y2="230" stroke="black" stroke-width="0.5" />
        <text x="97.5" y="240" font-size="10" font-family="Arial" fill="black">50</text>

        <line x1="110" y1="190" x2="100" y2="190" stroke="black" stroke-width="0.5" />
        <text x="97.5" y="200" font-size="10" font-family="Arial" fill="black">60</text>

        <line x1="110" y1="150" x2="100" y2="150" stroke="black" stroke-width="0.5" />
        <text x="97.5" y="160" font-size="10" font-family="Arial" fill="black">70</text>

        <line x1="110" y1="110" x2="100" y2="110" stroke="black" stroke-width="0.5" />
        <text x="97.5" y="120" font-size="10" font-family="Arial" fill="black">80</text>

        <line x1="110" y1="70" x2="100" y2="70" stroke="black" stroke-width="0.5" />
        <text x="97.5" y="80" font-size="10" font-family="Arial" fill="black">90</text>

        <line x1="110" y1="30" x2="100" y2="30" stroke="black" stroke-width="1" />
        <text x="93" y="40" font-size="10" font-family="Arial" fill="black">100</text>
    

      </g>
      <rect id="temperature-box" x="130" y="150" width="60" height="30" fill="antiquewhite" stroke="brown" />
      <text id="temperature-value" x="140" y="170" font-size="16" font-family="Calibiri" fill="brown">25°C</text>
      <text x="520" y="310" fill="Brown" font-size="25" font-family="Arial">μA</text>
      <text x="735" y="310" fill="Brown" font-size="25" font-family="Arial">Volts</text>
      <text id="Is-value-text" x="510" y="360" fill="red" font-size="25" font-family="Calibiri">16.00</text>
      <text id="voltmeter-value" x="740" y="360" font-size="25" font-family="calibiri" fill="red" >1.00 </text>
      <polygon points="760,420 750,440 770,440" id="upButton" />  
      <polygon points="760,465 750,445 770,445"id="downButton" />


    </svg>


  </div>

  <div id="valuesArray">
    <h3>OBSERVATONS</h3>
    <table>
      <thead>
        <tr>
          <th>Temperature (°C)</th>
          <th>Temperature T (K)</th>
          <th>Saturation current (micro A)</th>
          <th>log(Is)</th>
          <th>(10^3)/T</th>
          
          

        </tr>
      </thead>
      <tbody id="valuesTableBody">

      </tbody>
    </table>
  </div>
  <div id="chart-container">
    <canvas id="myChart"></canvas>
</div>
<body>
  <h1>RESULT </h1>
  <div id="slopeOutput"
  style="  font: Calibri;
  font-size: 30;"></div> 
</body>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    let direction = 1; 
    let requestId;
    let voltmeterValue = 1.0;

    let currentTemperature = 0;  
    let currentIs = 0;  
    let Is = 0;  
    let readings = []; 
    const riseSpeed = 0.5
    const fallSpeed = 0.03;
    let hasCompletedCycle = false;

    function updateVoltmeter() {
      document.getElementById('voltmeter-value').textContent = voltmeterValue.toFixed(1) ;
    }
    document.getElementById('upButton').addEventListener('click', () => {
      voltmeterValue += 0.5; 
      updateVoltmeter();
    });
    document.getElementById('downButton').addEventListener('click', () => {
      if (voltmeterValue>0){
        voltmeterValue -= 0.5;}

      
      updateVoltmeter();
    });

    

    function calculateIs(temperatureCelsius,voltmeterValue) {
      const temperatureKelvin = temperatureCelsius + 273.25;
      const Is = 7.2*voltmeterValue* Math.exp(1.79 * (2.9 - (1000 / temperatureKelvin)));
      return Is;
    }

    function animateThermometer() {
      const redRectangle = document.getElementById('thermometer-reading');
      const temperatureValue = document.getElementById('temperature-value');
      const isValueText = document.getElementById('Is-value-text');  
      const currentHeight = parseFloat(redRectangle.getAttribute('height'));
      const currentY = parseFloat(redRectangle.getAttribute('y'));
 

      const maxHeight = 380; 
      const minHeight = 100;  

      
      const speed = direction === 1 ? riseSpeed : fallSpeed;

      
      const newHeight = currentHeight + direction * speed;
      const newY = currentY - direction * speed;

      
      if (newHeight >= maxHeight) {
        direction = -1; 
      } else if (newHeight <= minHeight && direction === -1) {
        
        cancelAnimationFrame(requestId);
        hasCompletedCycle = true;
        return;
      }
      
      redRectangle.setAttribute('height', newHeight);
      redRectangle.setAttribute('y', newY);

      
      const temperature = Math.round(((430-newY) / 400) * 100);


      

      currentTemperature = temperature;
      temperatureValue.textContent = `${temperature}°C`;

      Is = calculateIs(temperature,voltmeterValue);
      isValueText.textContent = ` ${Is.toFixed(2)} `;

      if (temperature <= 85 && direction === -1) {
      document.getElementById('takeReadingButton').style.display = 'block';
    }

      
      requestId = requestAnimationFrame(animateThermometer);
  }

  function calculateSlope(readings) {
    if (readings.length < 2) {
        console.error("Need at least two points to calculate slope");
        return;
    }

    let x1 = readings[0].inverseTemperature; 
    let y1 = readings[0].logIs; 
    let x2 = readings[readings.length - 1].inverseTemperature;
    let y2 = readings[readings.length - 1].logIs;          

    
    let slope = (y2 - y1) / (x1 - x2);

 
    console.log(`Slope formula: ${(y2 - y1) / (x2 - x1)}`);
    console.log(`Slope: (${y2} - ${y1}) / (${x1} - ${x2}) = ${slope}`);

    let Eg=slope*2*0.198

    document.getElementById("slopeOutput").innerText = `Slope: (${y2} - ${y1}) / (${x1} - ${x2}) = ${slope}\nThe output Bandgap energy of the material is 2 * 0.198 * slope\nwhich is 2 * 0.198 * ${slope}\nwhich is ${Eg} eV`;

}




  function generateGraph(){
    document.getElementById("takeReadingButton").style.display = "none"; 
    const labels = readings.map(reading => (1000 / reading.temperatureKelvin).toFixed(2)); // (10^3)/T
  const logIsValues = readings.map(reading => Math.log10(reading.Is));
  const ctx = document.getElementById('myChart').getContext('2d');
  new Chart(ctx, {
    type: 'line',
    data: {
      labels: labels,
      datasets: [{
        label: 'log(Is) vs (10^3)/T',
        data: logIsValues,
        borderColor: 'red',
        backgroundColor: 'rgba(255, 0, 0, 0.2)',
        borderWidth: 2,
      }]
    },
    options: {
      scales: {
        x: {
          title: {
            display: true,
            text: '(10^3)/T',
            font: {
              size: 14,
            }
          }
        },
        y: {
          title: {
            display: true,
            text: 'log(Is)',
            font: {
              size: 14
                        }

          },
          ticks: {
            stepSize: 0.01,
          }
        }
      },
      responsive: true,
      maintainAspectRatio: false,

    }
    
  });
  calculateSlope(readings)

}

  function showReadings() {
   const temperatureCelsius = currentTemperature;
  const temperatureKelvin = temperatureCelsius + 273.15;
  const Is = calculateIs(temperatureCelsius,voltmeterValue);
  const logIs = Math.log(Is);
  const inverseTemperature = 1000 / temperatureKelvin;
  const DIs=Is.toFixed(3);
  alert(`Reading added to Observations
Current temperature: ${temperatureCelsius}
Saturation Current Is: ${DIs}`);

  readings.push({
    temperatureCelsius: temperatureCelsius,
    temperatureKelvin: temperatureKelvin,
    Is: Is,
    logIs: logIs,
    inverseTemperature: inverseTemperature,
  });
  const tableBody = document.getElementById('valuesTableBody');
  const newRow = document.createElement('tr');
  newRow.innerHTML = `
    <td>${temperatureCelsius.toFixed(2)}</td>
    <td>${temperatureKelvin.toFixed(2)}</td>
    <td>${Is.toFixed(4)}</td>
    <td>${logIs.toFixed(2)}</td>
    <td>${inverseTemperature.toFixed(2)}</td>
  `;
  tableBody.appendChild(newRow);
  if (readings.length >= 5) {
    document.getElementById("takeReadingButton").style.display = "none"; 
    document.getElementById('generateGraphButton').style.display = 'block';
  }
  }

  function startAnimation() {
    if (!requestId && !hasCompletedCycle) {
      animateThermometer();
    }
    document.getElementById("turnOnOvenButton").style.display = "none"; 
    }

  </script>
</body>
</html>
